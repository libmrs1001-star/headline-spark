# ==============================================================================
#                      è¯Šæ–­è„šæœ¬ 1: test_secrets.py
# ==============================================================================
import streamlit as st

st.title("ğŸ” AI åŠŸèƒ½è¯Šæ–­ - ç¬¬ä¸€å±‚ï¼šå¯†é’¥è¯»å–æµ‹è¯•")

st.write("---")
st.subheader("æ­£åœ¨å°è¯•ä» st.secrets ä¸­è¯»å– DEEPSEEK_API_KEY...")

try:
    # å°è¯•è¯»å–æˆ‘ä»¬é…ç½®çš„å¯†é’¥
    api_key = st.secrets["DEEPSEEK_API_KEY"]

    # å¦‚æœæˆåŠŸè¯»å–ï¼Œå°±æ˜¾ç¤ºä¸€äº›ä¿¡æ¯
    st.success("âœ… æˆåŠŸè¯»å–åˆ° API å¯†é’¥ï¼")
    
    st.write("**è¯»å–åˆ°çš„å¯†é’¥å†…å®¹ (ä¸ºäº†å®‰å…¨ï¼Œåªæ˜¾ç¤ºå‰å‡ ä½å’Œåå‡ ä½):**")
    
    # ä¸ºäº†å®‰å…¨ï¼Œæˆ‘ä»¬ç»ä¸å®Œæ•´æ˜¾ç¤ºå¯†é’¥ï¼Œåªæ˜¾ç¤ºä¸€ä¸ªâ€œé¢å…·â€
    masked_key = f"{api_key[:5]}...{api_key[-4:]}"
    st.code(masked_key, language="text")

    st.info("è¯Šæ–­ç»“è®ºï¼šStreamlit Cloud çš„ Secrets åŠŸèƒ½å·¥ä½œæ­£å¸¸ï¼é—®é¢˜ä¸åœ¨äºå¯†é’¥çš„è¯»å–ã€‚")

except Exception as e:
    # å¦‚æœè¯»å–å¤±è´¥ï¼Œå°±æ˜¾ç¤ºä¸€ä¸ªæ¸…æ™°çš„é”™è¯¯
    st.error("âŒ è¯»å– API å¯†é’¥å¤±è´¥ï¼")
    
    st.write("**æ•è·åˆ°çš„é”™è¯¯ä¿¡æ¯ï¼š**")
    st.exception(e)

    st.warning("è¯Šæ–­ç»“è®ºï¼šé—®é¢˜å¾ˆå¯èƒ½å‡ºåœ¨ Streamlit Cloud çš„ Secrets é…ç½®ä¸Šã€‚è¯·æ£€æŸ¥ä½ çš„å¯†é’¥åç§°å’Œå†…å®¹æ˜¯å¦å®Œå…¨æ­£ç¡®ã€‚")